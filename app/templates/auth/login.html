{% extends "base.html" %}

{% block title %}Login - StudioManager{% endblock %}

{% block page_title %}
<div class="page-header">
    <h1 class="page-title">Welcome Back</h1>
    <p class="page-description">Sign in to your StudioManager account</p>
</div>
{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <h2>Sign In</h2>
        </div>
        
        <form id="login-form" class="auth-form" novalidate>
            <!-- CSRF Token -->
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            
            <!-- Email Field -->
            <div class="form-group">
                <label for="email" class="form-label">Email Address</label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    class="form-input" 
                    required 
                    autocomplete="email"
                    placeholder="Enter your email address"
                >
                <div class="field-error" id="email-error"></div>
            </div>
            
            <!-- Password Field -->
            <div class="form-group">
                <label for="password" class="form-label">Password</label>
                <div class="password-field">
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-input" 
                        required 
                        autocomplete="current-password"
                        placeholder="Enter your password"
                    >
                    <button type="button" class="password-toggle" id="password-toggle">
                        <svg class="eye-icon" width="20" height="20" viewBox="0 0 20 20">
                            <path d="M10 3C5 3 1.73 7.11 1 10c.73 2.89 4 7 9 7s8.27-4.11 9-7c-.73-2.89-4-7-9-7zm0 12a5 5 0 110-10 5 5 0 010 10zm0-8a3 3 0 100 6 3 3 0 000-6z"/>
                        </svg>
                    </button>
                </div>
                <div class="field-error" id="password-error"></div>
            </div>
            
            <!-- Remember Me Checkbox -->
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="remember_me" name="remember_me" class="form-checkbox">
                    <label for="remember_me" class="checkbox-label">
                        Keep me signed in for 30 days
                    </label>
                </div>
            </div>
            
            <!-- Form Error Display -->
            <div id="form-error" class="form-error" style="display: none;"></div>
            
            <!-- Submit Button -->
            <div class="form-group">
                <button type="submit" class="btn btn-primary btn-full" id="login-submit">
                    <span class="btn-text">Sign In</span>
                    <div class="btn-spinner" style="display: none;">
                        <div class="spinner-small"></div>
                    </div>
                </button>
            </div>
        </form>
        
        <!-- Additional Links -->
        <div class="auth-footer">
            <div class="auth-links">
                <a href="#" class="auth-link">Forgot your password?</a>
            </div>
            <div class="auth-divider">
                <span>Don't have an account?</span>
            </div>
            <div class="auth-links">
                <a href="{{ url_for('auth.register') }}" class="auth-link auth-link-primary">
                    Create a new account
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Initialize login form handling when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        // Redirect authenticated users to dashboard
        if (Auth.isAuthenticated()) {
            window.location.href = '/dashboard';
            return;
        }
        
        // Initialize login form
        Auth.initLoginForm();
        
        // Focus email field
        document.getElementById('email').focus();
        
        // Password visibility toggle
        const passwordToggle = document.getElementById('password-toggle');
        const passwordField = document.getElementById('password');
        
        passwordToggle.addEventListener('click', function() {
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                passwordToggle.classList.add('active');
            } else {
                passwordField.type = 'password';
                passwordToggle.classList.remove('active');
            }
        });
    });
</script>
{% endblock %}